<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css" integrity="sha384-zCbKRCUGaJDkqS1kPbPd7TveP5iyJE0EjAuZQTgFLD2ylzuqKfdKlfG/eSrtxUkn" crossorigin="anonymous">

    <title>Back office - Admin Page</title>
  </head>
  <body>
    <h1>Hello!</h1>

    <nav class="navbar navbar-expand-lg navbar-dark bg-success">
        <a class="navbar-brand" href="#">CRUD Project</a>
        <button
          class="navbar-toggler"
          type="button"
          data-toggle="collapse"
          data-target="#navbarSupportedContent"
          aria-controls="navbarSupportedContent"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="navbar-toggler-icon"></span>
        </button>
  
        <div class="collapse navbar-collapse" id="navbarSupportedContent">
          <ul class="navbar-nav mr-auto">
            <li class="nav-item">
              <a class="nav-link" href="./front.html">Home</a>
            </li>
            <li class="nav-item">
              <a class="nav-link active" href="./back.html"
                >Backoffice <span class="sr-only">(current)</span></a
              >
            </li>
          </ul>
        </div>
      </nav>
  
      <h2 class="mt-4 text-center">Backoffice Form</h2>
  
      <div class="container">
        <div class="row justify-content-center mt-4">
          <div class="col col-md-6">
            <form onsubmit="createNewEvent(event)">
              <div class="form-group">
                <label for="name-input">Product Name</label>
                <input
                  type="text"
                  class="form-control"
                  id="name-input"
                  aria-describedby="name field"
                />
              </div>
              <div class="form-group">
                <label for="description-input">Description</label>
                <input
                  type="text"
                  class="form-control"
                  id="description-input"
                  aria-describedby="description field"
                />
              </div>
              <div class="form-group">
                <label for="description-input">Brand</label>
                <input
                  type="text"
                  class="form-control"
                  id="brand-input"
                  aria-describedby="brand field"
                />
              </div>
              <div class="form-group">
                <label for="description-input">Image url</label>
                <input
                  type="text"
                  class="form-control"
                  id="image-input"
                  aria-describedby="image field"
                />
              </div>
              <div class="form-group">
                <label for="price-input">Price</label>
                <input
                  type="number"
                  class="form-control"
                  id="price-input"
                  aria-describedby="price field"
                />
              </div>
  
              <button type="submit" class="btn btn-primary">Submit</button>
            </form>
          </div>
        </div>
      </div>

    

    <!-- Option 1: jQuery and Bootstrap Bundle (includes Popper) -->
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-fQybjgWLrvvRgtW6bFlB7jaZrFsaBXjsOMm/tB9LTS58ONXgqbR9W8oWht/amnpF" crossorigin="anonymous"></script>


    <script
    src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js"
    integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
    crossorigin="anonymous"
  ></script>
  <script
    src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-fQybjgWLrvvRgtW6bFlB7jaZrFsaBXjsOMm/tB9LTS58ONXgqbR9W8oWht/amnpF"
    crossorigin="anonymous"
  ></script>

  <script>
    const createProduct = async (data) => {
      // we're going to fall here when we click the submit button! :)
      // how do we send our event to the API for being generated on the db?
      // remember: RESTful APIS are STATELESS. so this means we need to inform the APIs
      // about our creation intentions, and we need to ATTACH to our request all the
      // properties: name, description, price and time

      // first, let's retrieve the data OUT of the form (because we need those properties
      // for our request)

     data.preventDefault()
      // preventDefault() STOPS the embedded browser behavior
      // put this for preventing the browser from refreshing!

      const newProduct = {
        name: document.getElementById('name-input').value,
        description: document.getElementById('description-input').value,
        brand: document.getElementById('brand-input').value,
        image: document.getElementById('image-input').value,
        price: document.getElementById('price-input').value,
       
      }

      console.log(newProduct)
      // now this works! myNewEvent is an object containing all the properties for
      // creating a new event

      // the next step will be: SEND IT to the API!

      // I'll use the async/await pattern

      try {
        const response = await fetch(
          'https://striveschool-api.herokuapp.com/api/product/',
          {
            method: 'POST',
            body: JSON.stringify(newProduct), // <-- we need to transform our event object
            // into a string, because that's what is accepted from our APIs
            headers: {
                'Authorization': 'Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJfaWQiOiI2MjQyZmRkYWRhMTNhZjAwMTUyYzFjNjEiLCJpYXQiOjE2NDg1NTc1MzAsImV4cCI6MTY0OTc2NzEzMH0.1fiNrhDESdvdEFh1zl2Bf25P8v-Ye92rEHztfRlg7b0',
                'Content-Type': 'application/json',
            },
           
          }
        )
        if (response.ok) {
          alert('Successfully added product!')
    
            document.getElementById('name-input').value = ''
            document.getElementById('description-input').value = ''
            document.getElementById('brand-input').value = ''
            document.getElementById('image-input').value= ''
            document.getElementById('price-input').value=''
        } else {
         
          alert('Problem occured')
        }
      } catch (error) {
        console.log(error)
      }
    }
  </script>

  </body>
</html>